<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SpacePipes</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="space-pipes">Space Pipes!</h1>
<p>So recently the amazing community run by Christian Henson called <a href="https://www.pianobook.co.uk/">Pianobook</a> hosted a contest to produce an instrument based on an audio sample of 29 bagpipes warming up in a school yard. The sound is exactly what you would imagine ‚Äì a blaring drone of discordant harmonies fading in and out of each other. <a href="https://lachlan00.github.io/pianobook/Space_Pipes/audio/29%20Bagpipes%20Tuning%20Up.wav">Have a listen</a>! It‚Äôs a a very interesting and textured sound but definitely a tricky sample to build an instrument out of. This is because‚Ä¶</p>
<p><strong>Q.</strong> What‚Äôs the definition of a minor second?<br>
<strong>A.</strong> Two bagpipes playing in unison. üòÇ</p>
<p>This post is to share how I created my Kontakt instrument ‚Äú<strong>Space Pipes</strong>‚Äù from this awful cacophony. This is my first effort at producing a Kontakt instrument and I‚Äôm quite pleased with the results. To me it sounds like a celestial space organ but it has another mode that produces a real horrid bagpipe granular texture layer. I haven‚Äôt had time to make a demo track so if you‚Äôd like to hear it in action you can download the Kontakt patch here: <a href="https://www.dropbox.com/s/mijja37b212cjlz/SpacePipes.zip?dl=0"><strong>Download the instrument!</strong></a></p>
<p><img src="https://lachlan00.github.io/pianobook/Space_Pipes/imgs/spacepipes_UI.png" alt="Space Pipes" width="600"><br>
<em>Introducing SpacePipes!</em></p>
<h2 id="islands-and-penguins">1. Islands and Penguins</h2>
<p>Typically for these Pianobook contests you would produce a video to share how we these instruments are built. Unfortunately/fortunately this is not possible for me as in my day job I work as a marine ecologist. Right now I‚Äôm working on an island in southern NSW, Australia GPS tagging penguins. As a consequence we don‚Äôt have access to reliable or good internet to upload a large video file.</p>
<p>I still want to be able to share what I‚Äôve done with Pianobook however so I thought instead I‚Äôd just write a quick markdown document giving an overview of my process. For those that are more interested in penguins than my odd little Kontakt instrument (I imagine that‚Äôs probably everyone) feel free to message me and I‚Äôll give a brief description of my research and what I‚Äôm doing out here.</p>
<p><img src="https://lachlan00.github.io/pianobook/Space_Pipes/imgs/island1.jpeg" alt="The Island" width="800"><br>
<em>The Remote and beautiful island I‚Äôm currently working from.</em></p>
<h2 id="tuning-the-bagpipes">2. Tuning the Bagpipes</h2>
<p>First things first. In order to make a musical instrument out of this sound it would help us if the sound itself tuned to a typical musical pitch. As it turns out the tuning of bagpipes is not actually that straight forward a task! Well a quick google reveals that bagpipes typically tune to <strong>Bb</strong> which has the frequency 466.16 Hz. So first thing I did is play a <strong>Bb</strong> sine wave over the top of the sample to see if that‚Äôs indeed what they were playing‚Ä¶ However in true bagpipe fashion, <a href="https://lachlan00.github.io/pianobook/Space_Pipes/audio/raw-Bbsine.wav"><strong>this sounded garbage!</strong> Have a listen!</a></p>
<p><img src="https://lachlan00.github.io/pianobook/Space_Pipes/imgs/raw-Bbsine.png" alt="sound clash" width="800"><br>
<em>These sounds clashed horribly!</em></p>
<p>Well obviously, the bagpipes are a little more complex than I thought so a little more research was required to work out what was going on here. Well as it turns out, for a slew of historical reasons to do with how the writing of music has evolved over the years, it turns out that the <strong>Bb</strong> modern bagpipes tune to is actually between 476 to 480 Hz! This is roughly halfway between <strong>Bb</strong> and <strong>B</strong>. So in order to have a well functioning instrument, we will need to do some slight pitch shifting to the instrument.</p>
<p>Well there are two ways we can work out how much we need to shift our note. (1) We can just tune to our reference <strong>Bb</strong> until it sounds about right to us or (2) we can do a little bit of mathematics to work out exactly how many cents we need to pitch shift the sample to do the impossible and get a perfectly in tune bagpipe! Obviously I‚Äôm going to take the second approach because I love making things needlessly difficult.</p>
<p>Basically what we want to do is calculate how many cents we need to retune our sample from ~ 478 Hz to 466.16 Hz (<strong>Bb</strong>). It actually isn‚Äôt that difficult to do this. Musical notes and their respective frequencies follow something called a binary logarithmic scale. This basically means, each octave is double the frequency of the previous octave. Here‚Äôs a nice visual representation of this.</p>
<p><img src="http://digitalsoundandmusic.schwartzsound.com/wp-content/uploads/2014/05/Figure-4.7-Non-linear-nature-of-pitch-perception.png" alt="music octaves" width="800"><br>
<em>Music Octaves - each octave is double the frequency of the previous and thus follows a binary logarithmic scale.</em></p>
<p>A <em>cent</em> is one 100th of a note. Consequently in order to calculate how many cents we need to shift our sample, we can use the binary logarithm applied to the ratio between our two desired frequencies. To get the cents we just times this by 1200 because there are 12 notes in an octave and each has 100 cents (12x100 = 1200). So here‚Äôs our formula:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>s</mi><mo>=</mo><mn>1200</mn><mo>√ó</mo><msub><mo><mi>log</mi><mo>‚Å°</mo></mo><mn>2</mn></msub><mo stretchy="false">(</mo><msub><mi>f</mi><mn>1</mn></msub><mi mathvariant="normal">/</mi><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>‚àí</mo><mo stretchy="false">(</mo><msub><mi>f</mi><mn>1</mn></msub><mi mathvariant="normal">/</mi><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> 
cents = 1200 \times \log_{2}(f_{1}/f_{2}) - (f_{1}/f_{2})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.206968em;"><span class="" style="top: -2.45586em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p>
<p>And when we put in our values we get this‚Ä¶</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>s</mi><mo>=</mo><mn>1200</mn><mo>√ó</mo><msub><mo><mi>log</mi><mo>‚Å°</mo></mo><mn>2</mn></msub><mo stretchy="false">(</mo><mn>478</mn><mi mathvariant="normal">/</mi><mn>466.16</mn><mo stretchy="false">)</mo><mo>‚àí</mo><mo stretchy="false">(</mo><mn>478</mn><mi mathvariant="normal">/</mi><mn>466.16</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex"> 
cents = 1200 \times \log_{2}(478/466.16) - (478/466.16) \\
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.206968em;"><span class="" style="top: -2.45586em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">4</span><span class="mord">7</span><span class="mord">8</span><span class="mord">/</span><span class="mord">4</span><span class="mord">6</span><span class="mord">6</span><span class="mord">.</span><span class="mord">1</span><span class="mord">6</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">4</span><span class="mord">7</span><span class="mord">8</span><span class="mord">/</span><span class="mord">4</span><span class="mord">6</span><span class="mord">6</span><span class="mord">.</span><span class="mord">1</span><span class="mord">6</span><span class="mclose">)</span></span><span class="mspace newline"></span></span></span></span></span></p>
<p>Which equals just under 43 cents. So I shifted down the sample by 43 cents and then once again tried playing it alongside the <strong>Bb</strong> sine wave. <a href="https://lachlan00.github.io/pianobook/Space_Pipes/audio/rawtuned-Bbsine.wav">The result was much more pleasing to the ear!</a></p>
<p><img src="https://lachlan00.github.io/pianobook/Space_Pipes/imgs/retune.png" alt="retune" width="800"><br>
<em>Shifting the sample down 43 cents.</em></p>
<h2 id="making-it-musical">3. Making it Musical</h2>
<p>Now that we have achieved the remarkable feat of tuning a bagpipe we can proceed with impossible task of turning this awful cacophony into something somewhat musical. This is a pretty difficult task because if you listen to the sample you will hear that other than the main drone in <strong>Bb</strong> there are all sorts of overtones and runs being played, all of them fading in and out of each other. This makes it very difficult to make a sample based instrument that can play chords and multiple notes as these overtones will clash with each other. I experimented for hours with a whole range of different processing methods to turn these into simplified drones and sounds with a bit of success but I would always have this same problem when it came to playing chords or anything other than 5ths on the keyboard.</p>
<p>Fortunately for me I recently watched a video by a very talented Pianobook community member named David Hilowitz. <a href="https://www.youtube.com/watch?v=xsi8yrHN0ss">In this video</a> David demonstrates how he extracted music elements from the rusty gate sample (for another Pianobook contest) using a software by Izotope called <a href="https://www.izotope.com/content/izotope/en/products/rx.html">RX Elements</a>. After seeing the utility of this software I had to have it, and luckily for me it was on special for $29.</p>
<p>So now I could go feed in my newly tuned bagpipe sample and go through and extract a bunch of isolated musical notes from the instruments and ignore all of those difficult to work with overtones and runs going on in the sample.</p>
<p><img src="https://lachlan00.github.io/pianobook/Space_Pipes/imgs/rx-all.png" alt="RX Elements" width="800"><br>
<em>RX Elements allows you to explore your audio files as a frequency ‚Äúheatmap‚Äù where your x-axis is time, y-axis is the frequency and the colour (heat) indicates a frequency‚Äôs volume in decibels.</em></p>
<p>I was really impressed with this software. Here‚Äôs a quick screen shot where I isolated the vocal call of someone in the sample (it appears at 5 seconds). I didn‚Äôt end up using this particular extraction for Space Pipes (I wanted this to be bagpipe focused) but I made another ‚Äúwhistle‚Äù instrument out of it that sounds pretty cool that maybe I‚Äôll share a bit later. <a href="https://lachlan00.github.io/pianobook/Space_Pipes/audio/Call.wav">Here‚Äôs the sound that I isolated in the below image</a>.</p>
<p><img src="https://lachlan00.github.io/pianobook/Space_Pipes/imgs/rx-call.png" alt="RX Elements" width="800"><br>
<em>Isolating a vocal snippet from the bagpipes sample</em></p>
<p>Once I had a few isolated notes I choose my favourite and did a bit of cleaning and fed this into the Kontakt. Then I added a few effects and EQ and and scripted up a beautiful looking interface. I have to say I‚Äôm pretty pleased with the results. If you haven‚Äôt already <a href="https://www.dropbox.com/s/mijja37b212cjlz/SpacePipes.zip?dl=0"><strong>download the instrument!</strong></a> and have a play yourself!</p>
<h2 id="laser-eyes-and-granular-synthesis">4. Laser Eyes and Granular Synthesis?</h2>
<p>So after all this work I had a pretty freaking awesome space organ instrument that I believe rivals that of Spitfire‚Äôs <a href="%5Bhttps://www.spitfireaudio.com/shop/a-z/symphonic-organ/%5D(https://www.spitfireaudio.com/shop/a-z/symphonic-organ/)">Symphonic Organ</a> üòâ! It sounds very clean and we‚Äôve dealt with all those difficult overtones and textures that make the instrument difficult to play. But you know what! I kinda miss all that rubbish as that really is what makes bagpipes bagpipe like right?</p>
<p>So I decided it would be really neat to have a secondary mode within the instrument that really focuses in on those sounds and textures you hear within the original sample. To do this I decided I would resample the original sample using some granular synthesis techniques. This is because I really love having elements of chaos and randomness in my soundscapes and I think this particular sample is perfect for this with all the little amazing textures throughout it (all the random drum hits and people hollering make it super cool!). Also why not have this mode controlled by the ‚Äúlaser eyes‚Äù of a space pipe wielding astro explorer? I know right, such an obvious idea.</p>
<p><img src="https://lachlan00.github.io/pianobook/Space_Pipes/imgs/lasereyes.png" alt="Laser Eyes" width="600"><br>
<em>Using laser eyes to control the amount of crazy granular bagpipe texture!</em></p>
<p>I decided to use a max4live <a href="https://www.ableton.com/en/packs/granulator/">granulator</a> built by Robert Henke (aka Monolake) to build the textures for this part of the instrument because it‚Äôs a really awesome granulator that has a really creative randomisation engine with lots of fine scale control. It‚Äôs really impressive work.</p>
<p><img src="https://lachlan00.github.io/pianobook/Space_Pipes/imgs/granulator.gif" alt="Granulator" width="600"><br>
<em>The awesome granulator by Monolake!</em></p>
<p>Another reason for using this granulator is that these projects are effectively open source so you can get in and fiddle with the source code or learn from it anyway you want. Definitely a good thing to support for an open community like Pianobook.</p>
<p><img src="https://lachlan00.github.io/pianobook/Space_Pipes/imgs/underthehood.png" alt="Granulator under the hood" width="600"><br>
<em>Under the hood of the granulator max4live instrument.</em></p>
<p>Once I had all the settings set up how I wanted, I loaded in the bagpipes and fed it through a few reverb and delay chains to smooth out the stutters and add even more texture to the sound. Then I set up a midi track to play through 5 octaves sampling at minor third intervals (3 half steps). I use minor thirds for sampling as I think this is a great trade off for effort and sampling. You only need to sample 4 notes per octave (in this case <strong>A</strong>, <strong>C</strong>, <strong>D#</strong> and <strong>F#</strong>) but when you map the notes, each sample will only need to be pitch shifted 1 semitone in any direction to cover the whole piano! This is great as it means my delay effects and other elements won‚Äôt get time warped by pitch shifting the samples. <a href="https://lachlan00.github.io/pianobook/Space_Pipes/audio/granulated_A1.wav">Here‚Äôs the result of this processing. Have a listen to A1!</a></p>
<p>Now I layered this sound over the space organ sound and added in the laser eye controls. This bit was really fun. I won‚Äôt go into the Kontakt scripting for this but my script in the Kontakt instrument patch is all open so feel free to dissect it. Also feel free to get in contact if you have any questions about any of this.</p>
<p>I was pretty pleased with the final result. I now have a pretty cool space organ that can be layered with some really interesting granular textures that can make for some really cool drones! Once again if you haven‚Äôt already <a href="https://www.dropbox.com/s/mijja37b212cjlz/SpacePipes.zip?dl=0"><strong>download the instrument!</strong></a> and have a play with it yourself!</p>
</div>
</body>

</html>
